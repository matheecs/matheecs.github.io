---
layout: post
title: "ğŸ› å·¥ç¨‹æ—¥å¿—"
categories: study
author: "Jixiang Zhang"
---

**ç›®å½•**

* toc
{:toc}
------

### å‚æ•°å–å€¼èŒƒå›´é”™è¯¯

åŸæ–‡é“¾æ¥ [ä¸€èµ·åšRGB-D SLAM (3)](http://www.cnblogs.com/gaoxiang12/p/4659805.html)

ä½¿ç”¨ CLionï¼Œå¼ºçƒˆæ¨èï¼Œæ¯” Qt Creator å¥½ç”¨ã€‚è°ƒè¯•ç»ˆæ­¢åœ¨ solvePnPRansac å‡½æ•°ï¼š

```shell
OpenCV Error: Assertion failed (confidence > 0 && confidence < 1) in run, file /Users/zhangjixiang/Downloads/opencv-3.3.1/modules/calib3d/src/ptsetreg.cpp, line 178`
`libc++abi.dylib: terminating with uncaught exception of type cv::Exception: /Users/zhangjixiang/Downloads/opencv-3.3.1/modules/calib3d/src/ptsetreg.cpp:178: error: (-215) confidence > 0 && confidence < 1 in function run
```

ç¨‹åºæºç ï¼š

```c++
cv::solvePnPRansac( pts_obj, pts_img, cameraMatrix, cv::Mat(), rvec, tvec, false, 100, 1.0, 100, inliers );
```

é”™è¯¯åŸå› ï¼šå‚æ•° confidence è¶…å‡ºäº† (0, 1) èŒƒå›´ã€‚

ç¨‹åºæ”¹ä¸ºï¼š

```c++
cv::solvePnPRansac( pts_obj, pts_img, cameraMatrix, cv::Mat(), rvec, tvec, false, 100, 1.0, 0.99, inliers );
```
å¯æ­£å¸¸è¿è¡Œã€‚

------

### å¤šä½™çš„æ‹¬å·

Bugæ¥æºï¼šå¤šä½™çš„æ‹¬å·

```c++
string value = str.substr((pos+1, str.length()));
```
è¿è¡Œæ—¶é”™è¯¯ï¼š

```shell
OpenCV Error: Assertion failed (npoints >= 4 && npoints == std::max(ipoints.checkVector(2, 5), ipoints.checkVector(2, 6))) in solvePnPRansac, file /Users/zhangjixiang/Downloads/opencv-3.3.1/modules/calib3d/src/solvepnp.cpp, line 252
libc++abi.dylib: terminating with uncaught exception of type cv::Exception: /Users/zhangjixiang/Downloads/opencv-3.3.1/modules/calib3d/src/solvepnp.cpp:252: error: (-215) npoints >= 4 && npoints == std::max(ipoints.checkVector(2, 5), ipoints.checkVector(2, 6)) in function solvePnPRansac
```
ç¨‹åºå¯ä¿®æ”¹ä¸ºï¼š
```c++
string value = str.substr(pos+1, str.length());
```
------

### macOS çº¿ç¨‹ä¸ UI

å¯¼è‡´å¼‚å¸¸çš„ä»£ç ï¼š

```c++
pcl::visualization::CloudViewer viewer("viewer");
viewer.showCloud(output);
while(!viewer.wasStopped())
{

}
```

è¿è¡Œæ—¶å‡ºé”™æç¤ºï¼š

```shell
2018-01-31 19:30:31.598 joinPointCloud[57826:4712504] *** Assertion failure in +[NSUndoManager _endTopLevelGroupings], /BuildRoot/Library/Caches/com.apple.xbs/Sources/Foundation/Foundation-1450.16/Foundation/Misc.subproj/NSUndoManager.m:361
2018-01-31 19:30:31.599 joinPointCloud[57826:4712504] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: '+[NSUndoManager(NSInternal) _endTopLevelGroupings] is only safe to invoke on the main thread.'
*** First throw call stack:
(
	0   CoreFoundation                      0x00007fff551cc00b __exceptionPreprocess + 171
	1   libobjc.A.dylib                     0x00007fff7be59c76 objc_exception_throw + 48
	2   CoreFoundation                      0x00007fff551d1da2 +[NSException raise:format:arguments:] + 98
	3   Foundation                          0x00007fff572de260 -[NSAssertionHandler handleFailureInMethod:object:file:lineNumber:description:] + 193
	4   Foundation                          0x00007fff5726cdb4 +[NSUndoManager(NSPrivate) _endTopLevelGroupings] + 469
	5   AppKit                              0x00007fff5271de56 -[NSApplication run] + 997
	6   libpcl_visualization.1.8.dylib      0x0000000105611c50 _ZN3pcl13visualization13PCLVisualizer8spinOnceEib + 318
	7   libpcl_visualization.1.8.dylib      0x00000001056323a1 _ZN3pcl13visualization11CloudViewer16CloudViewer_implclEv + 699
	8   libboost_thread-mt.dylib            0x00000001017902ac _ZN5boost12_GLOBAL__N_1L12thread_proxyEPv + 156
	9   libsystem_pthread.dylib             0x00007fff7ccd46c1 _pthread_body + 340
	10  libsystem_pthread.dylib             0x00007fff7ccd456d _pthread_body + 0
	11  libsystem_pthread.dylib             0x00007fff7ccd3c5d thread_start + 13
)
libc++abi.dylib: terminating with uncaught exception of type NSException
```


è§£å†³æ–¹æ³•ï¼šç”¨[PCLVisualizer](http://pointclouds.org/documentation/tutorials/pcl_visualizer.php)ä»£æ›¿CloudViewer

```c++
#include <pcl/visualization/pcl_visualizer.h>
...
pcl::visualization::PCLVisualizer viewer("viewer");
viewer.addPointCloud<pcl::PointXYZRGBA>(output);
while(!viewer.wasStopped())
{
	viewer.spinOnce();
}
```
ç±»ä¼¼çš„é”™è¯¯åŒæ ·å‘ç”Ÿåœ¨**ORB_SLAM2**

```c++
auto resultFuture = async(launch::async, processing, argv, &SLAM);
```

å¼‚å¸¸åŸå› ï¼š

- çº¿ç¨‹**Thread**
- UI

------

### PCL æ˜¾ç¤ºé—®é¢˜

å¯¼è‡´å¼‚å¸¸çš„ä»£ç ï¼š

```c++
pcl::visualization::CloudViewer viewer("viewer");
...
if ( visualize == true )
	viewer.showCloud( cloud );
```

è§£å†³æ–¹æ³•ï¼šç”¨[PCLVisualizer](http://pointclouds.org/documentation/tutorials/pcl_visualizer.php)ä»£æ›¿CloudViewer

å‚è€ƒç¨‹åºï¼š

```c++
pcl::visualization::PCLVisualizer viewer("viewer");
...
if ( visualize == true )
{
	viewer.removeAllPointClouds();
	viewer.addPointCloud( cloud, "hello");
	viewer.updatePointCloud( cloud, "hello" );
	viewer.spinOnce(0.0000000000001);
}
```

é™„èµ ä¸€ä¸ªbugï¼šæ¼å†™å‡½æ•°è¿”å›å€¼ï¼Œè¿è¡Œæ—¶å¼‚å¸¸åœæ­¢ï¼Œæç¤ºå‡½æ•°çš„å‚æ•°é”™è¯¯ï¼š

```shell
OpenCV Error: Assertion failed (npoints >= 4 && npoints == std::max(ipoints.checkVector(2, 5), ipoints.checkVector(2, 6))) in solvePnPRansac, file /Users/zhangjixiang/Downloads/opencv-3.3.1/modules/calib3d/src/solvepnp.cpp, line 252
libc++abi.dylib: terminating with uncaught exception of type cv::Exception: /Users/zhangjixiang/Downloads/opencv-3.3.1/modules/calib3d/src/solvepnp.cpp:252: error: (-215) npoints >= 4 && npoints == std::max(ipoints.checkVector(2, 5), ipoints.checkVector(2, 6)) in function solvePnPRansac
```
ä¿®æ”¹å»ºè®®ï¼š

```c++
inline static CAMERA_INTRINSIC_PARAMETERS getDefaultCamera()
{
    ParameterReader pd;
    CAMERA_INTRINSIC_PARAMETERS camera;
    camera.fx = atof(pd.getData("camera.fx").c_str());
    camera.fy = atof(pd.getData("camera.fy").c_str());
    camera.cx = atof(pd.getData("camera.cx").c_str());
    camera.cy = atof(pd.getData("camera.cy").c_str());
    camera.scale = atof(pd.getData("camera.scale").c_str());
    return camera;// Bug
}
```
------

### ç”¨å¥½è°ƒè¯•å™¨ lldb/gdb

CLion IDE ä¼˜ç‚¹å’Œç¼ºç‚¹ä¸€æ ·æ˜æ˜¾ï¼š

- ä»£ç è¡¥å…¨
- æ”¯æŒCMake
- è·³è½¬
- æ–¹ä¾¿ä»£ç æŸ¥çœ‹
- æ…¢ï¼Œä¸èƒ½å®¹å¿ï¼


æ•…æå‡ºæ›¿ä»£æ–¹æ¡ˆï¼š**CMake + GCC + LLDB + Sublime Text**

æ›¿ä»£æ–¹æ¡ˆçš„ä¼˜ç‚¹ï¼š

- å¿«ï¼Œçˆ½ï¼
- çµæ´»
- æ”¯æŒåŸºæœ¬è°ƒè¯•åŠŸèƒ½

IDE ä¸è¿‡æ˜¯å·å·åœ°å¸®ä½ è°ƒç”¨äº† GCCï¼ŒLLDBâ€¦â€¦

è°ƒè¯•æ–¹æ³•

```shell

$ gdb ./my_program          # Start GDB on your program
> run                       # Start running your program
...                         # Now reproduce the crash!
> bt                        # Obtain the backtrace
```



èµ„æ–™ä¸å‚è€ƒæ–‡çŒ®ï¼š

1. [The LLDB Debugger](http://lldb.llvm.org/lldb-gdb.html)

------

### ç¼–è¯‘å™¨ä¼˜åŒ–

slambook/project/0.4/CMakeLists.txt

```cmake
set( CMAKE_BUILD_TYPE "Debug" )
set( CMAKE_CXX_FLAGS "-std=c++11 -march=native -O3" )
```

å¯¼è‡´è¿è¡Œæ—¶é”™è¯¯

```shell
Assertion failed: (( ((internal::UIntPtr(m_data) % internal::traits<Derived>::Alignment) == 0) || (cols() * rows() * innerStride() * sizeof(Scalar)) < internal::traits<Derived>::Alignment ) && "data is not aligned"), function checkSanity, file /usr/local/include/eigen3/Eigen/src/Core/MapBase.h, line 191.
```

ä¿®æ”¹CMakeLists.txtä¸º

```cmake
set( CMAKE_BUILD_TYPE "Release" )
set( CMAKE_CXX_FLAGS "-std=c++11" )
```

å¯æ­£å¸¸è¿è¡Œã€‚åŸå› ï¼šç¼–è¯‘å™¨**ä¼˜åŒ–**å¯¼è‡´çš„**å†…å­˜å¯¹é½**é”™è¯¯ï¼Ÿ

ä½†è¿è¡Œç»ˆæ­¢äº

```shell
****** loop 347 ******
extract keypoints cost time: 0.008442
descriptor computation cost time: 0.008491
good matches: 10
match cost time: 0.001327
pnp inliers: 8
T_c_w_estimated_:
-0.0794355  -0.220607   0.972123    2.80445
 0.0189232   0.974695   0.222737    4.95924
  -0.99666  0.0360889 -0.0732508  -0.908356
         0          0          0          1
reject because inlier is too small: 8
VO costs time: 0.021043

****** loop 348 ******
extract keypoints cost time: 0.009256
descriptor computation cost time: 0.007454
good matches: 2
match cost time: 0.000996
OpenCV Error: Assertion failed (npoints >= 4 && npoints == std::max(ipoints.checkVector(2, 5), ipoints.checkVector(2, 6))) in solvePnPRansac, file /Users/zhangjixiang/Downloads/opencv-3.3.1/modules/calib3d/src/solvepnp.cpp, line 252
libc++abi.dylib: terminating with uncaught exception of type cv::Exception: /Users/zhangjixiang/Downloads/opencv-3.3.1/modules/calib3d/src/solvepnp.cpp:252: error: (-215) npoints >= 4 && npoints == std::max(ipoints.checkVector(2, 5), ipoints.checkVector(2, 6)) in function solvePnPRansac
```

åŸå› ï¼š**åŒ¹é…ç‚¹æ•°ç›®ä¸å¤Ÿ**å¯¼è‡´çš„ç¨‹åºç»ˆæ­¢ã€‚

Solutionï¼šå¢åŠ åŒ¹é…æ•°ç›®ï¼Œå°† 100 å¢åŠ ä¸º 200

```c++
if ( match_2dkp_index_.size() < 200 )
        addMapPoints();
```

### OpenGL å¤´æ–‡ä»¶

```c++
#if defined(__APPLE__)
#include <OpenGL/gl.h>
#include <OpenGL/glu.h>
#else
#include <GL/gl.h>
#include <GL/glu.h>
#endif
```

### LaTeX æ’ç‰ˆæŠ€å·§

##### æ’å…¥æºä»£ç 

```latex
\usepackage{listings}
\usepackage{xcolor}
\lstset{
%	numbers=left,
	numberstyle= \tiny,
	keywordstyle= \color{ blue!70},
	commentstyle= \color{red!50!green!50!blue!50},
	frame=shadowbox, % é˜´å½±æ•ˆæœ
	rulesepcolor= \color{ red!20!green!20!blue!20} ,
	escapeinside=``, % è‹±æ–‡åˆ†å·ä¸­å¯å†™å…¥ä¸­æ–‡
%	xleftmargin=2em,xrightmargin=2em, aboveskip=1em,
%	framexleftmargin=2em
}
...
\begin{lstlisting}
Hello World!
\end{lstlisting}
...
```

##### æ’å…¥å‚è€ƒæ–‡çŒ®

```latex
\cite{...}
...
\bibliographystyle{ieeetr}
\bibliography{name-of-bibtex-file}
```

##### æ’å…¥æ‘˜è¦å…³é”®å­—

```latex
\usepackage{abstract}
\providecommand{\keywords}[1]{\textbf{\textit{Index terms---}} #1}
...
\begin{abstract}
There is the abstract...
\end{abstract}
\begin{keywords}
Some keywords...
\end{keywords}
```

##### æ­£ä¸‹æ–¹æ’å…¥æ–‡å­—

```latex
\mathop{XXX}\limits_{XXX}
```

##### subfigures æ’å›¾

```latex
\documentclass{article}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\begin{document}
    \begin{figure}
        \centering
        \begin{subfigure}{0.4\textwidth} % width of left subfigure
            \includegraphics[width=\textwidth]{rncalt.png}
            \caption{RNC} % subcaption
        \end{subfigure}
        \vspace{1em} % here you can insert horizontal or vertical space
        \begin{subfigure}{0.4\textwidth} % width of right subfigure
            \includegraphics[width=\textwidth]{dncalt.png}
            \caption{DNC} % subcaption
        \end{subfigure}
        \caption{Wordcloud of national conventions} % caption for whole figure
    \end{figure}
\end{document}
```

##### å¤§æ‹¬å·æ–¹ç¨‹ç»„

```latex
\begin{equation}
\left\{
\begin{aligned}
a_{x}&=K_{A}\theta_{x}+K_{AV}\dot{\theta}_{x}+K_{T}(x-x_{0})+K_{V}v_{x}\\
a_{y}&=K_{A}\theta_{y}+K_{AV}\dot{\theta}_{y}+K_{T}(y-y_{0})+K_{V}v_{y}
\end{aligned}
\right.
\end{equation}
```

##### æ”¶è—é“¾æ¥ç›®å½•

```latex
\usepackage{hyperref}
```

##### æ–‡ä¸­æ·»åŠ æ¨ªçº¿

```latex
\rule{\textwidth}{1mm}
```

##### æ’å…¥ç©ºè¡Œ

```latex
\vspace{3ex}
```

##### è¡¨æ ¼çº¿åŠ ç²—

```latex
\usepackage{booktabs}
\toprule[2pt]
\midrule[1pt]

\bottomrule[2pt]
```

##### ä¸‹æ‹¬å·

```latex
\underbrace{\frac{\Delta x_1}{\Delta p_1}}_{\text{Tot eff}}
```

##### å·¦ä¸Šæ ‡

```latex
{}^{e}\dot{p}
```



### è®¡ç®—è¿è¡Œæ—¶é—´(å•çº¿ç¨‹)

```c++
#include <ctime>
...
clock_t time_stt = clock(); // è®¡æ—¶
...
cout <<"time use is " << 1000* (clock() - time_stt)/(double)CLOCKS_PER_SEC << "ms"<< endl;
```

### C++ å¤šçº¿ç¨‹è®¡æ—¶å‹¿ç”¨ clock()

> clock()å‡½æ•°çš„åŠŸèƒ½: è¿™ä¸ªå‡½æ•°è¿”å›ä»â€œå¼€å¯è¿™ä¸ªç¨‹åºè¿›ç¨‹â€åˆ°â€œç¨‹åºä¸­è°ƒç”¨C++ clock()å‡½æ•°â€æ—¶ä¹‹é—´çš„CPUæ—¶é’Ÿè®¡æ—¶å•å…ƒï¼ˆclock tickï¼‰æ•°å½“ç¨‹åºå•çº¿ç¨‹æˆ–è€…å•æ ¸å¿ƒæœºå™¨è¿è¡Œæ—¶ï¼Œè¿™ç§æ—¶é—´çš„ç»Ÿè®¡æ–¹æ³•æ˜¯æ­£ç¡®çš„ã€‚ä½†æ˜¯å¦‚æœè¦æ‰§è¡Œçš„ä»£ç å¤šä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œæ—¶å°±ä¼šå‡ºé—®é¢˜ï¼Œå› ä¸ºæœ€ç»ˆend-beginå°†ä¼šæ˜¯å¤šä¸ªæ ¸å¿ƒæ€»å…±æ‰§è¡Œçš„æ—¶é’Ÿå˜€å—’æ•°ï¼Œå› æ­¤é€ æˆæ—¶é—´åå¤§ã€‚

Solution

```c++
#include <chrono>
std::chrono::steady_clock::time_point t1 = std::chrono::steady_clock::now();
...
std::chrono::steady_clock::time_point t2 = std::chrono::steady_clock::now();
        chrono::duration<double> time_used = chrono::duration_cast<chrono::duration<double>>( t2-t1 );
        cout<<"time use in Tracking is "<< time_used.count() * 1000 <<"ms "<<endl;
```

### å›ºå®šç¿¼â€”æ’é€Ÿâ€”ç¼–é˜Ÿä¸è·Ÿè¸ª

å­™å¸ˆå…„å›å›½ç»™å¤§å®¶åˆ†äº«ä»–åšå£«æœŸé—´çš„ç§‘ç ”æˆæœï¼Œå¼ºè°ƒ**çŸ©é˜µè®º**çš„é‡è¦æ€§ã€‚è®²åº§ç¬”è®°

[https://matheecs.github.io/images/20180523.jpeg](/images/20180523.jpeg)

ç¬¬äºŒå¤©ä¸Šåˆå¸ˆå…„ç»™è¯¾é¢˜ç»„ç»„ç»‡åˆ†äº«ä¼šï¼Œå‡ ç‚¹æ”¶è·ï¼šæŒæ¡çŸ©é˜µå’Œä¼˜åŒ–ï¼ŒJust do it èµ¶èµ°æ‹–å»¶ç—‡ï¼Œè‹±è¯­å¾ˆé‡è¦ï¼

### åŒç›®æµ‹è·æ¨¡å—å®ç°æ–¹æ¡ˆï¼ˆTODO æš‘å‡ï¼‰

1. Zynq + xfOpenCV + Stereo Vision Pipeline
2. GPU TX2

åœ¨æ­¤åŸºç¡€ä¸Šè®¾è®¡ä¸€æ¬¾åŒç›®è§†è§‰æ•™è‚²æœºå™¨äººã€‚

FPGAé‡æ–°å­¦ä¹ éœ€è¦æ—¶é—´ï¼Œä½†ä¸æƒ³åœ¨ç¡¬ä»¶ä¸Šé¢èŠ±å¤ªå¤šæ—¶é—´ï¼Œè¿˜æ˜¯ä¸“æ³¨ç®—æ³•å’Œåˆ›æ„ã€‚

æ¯ä¸€ä¸ªé¢†åŸŸï¼ˆåŒç›®è§†è§‰ï¼‰éƒ½æ˜¯å‘ï¼Œä¸€ä¸å°å¿ƒå°±è·³ä¸‹å»å‡ºä¸æ¥äº†ï½



### æ€ç´¢ SLAM çš„çœŸæ­£ç›®çš„

1. ç”Ÿæˆé«˜ç²¾åº¦åœ°å›¾
2. ç”¨äºå¯¼èˆªï¼Œä½†å¯¼èˆªçœŸçš„éœ€è¦é«˜ç²¾åº¦çš„åœ°å›¾å—
3. åŒç†ï¼Œé‡Œç¨‹è®¡çš„é«˜ç²¾åº¦å¯¹äºä¸€èˆ¬çš„roboté‡è¦å—

æˆ–è®¸robotä¸éœ€è¦é«˜ç²¾åº¦çš„é‡Œç¨‹è®¡å’Œåœ°å›¾ï¼Œrobotåº”æ›´åƒäººä¸€æ ·ï¼Œè€Œä¸æ˜¯æœºå™¨ã€‚

æ‰€ä»¥æƒ³åˆ°è®¾è®¡ä¸€ä¸ª low resolution vision çš„ autonomous navigation mobile robotï½

### OpenCV 3.4 ç¼–è¯‘

æ ‘è“æ´¾éœ€è¦å…ˆä¿®æ”¹**è½¯ä»¶æº**ã€å®‰è£…**ä¾èµ–åº“**ã€‚

```shell
$ cmake \
-DCMAKE_BUILD_TYPE=RELEASE \
-DCMAKE_INSTALL_PREFIX=/usr/local \
-DOPENCV_EXTRA_MODULES_PATH=/Users/zhangjixiang/Downloads/opencv_contrib-3.4.0/modules \
-DWITH_CUDA=OFF \
-DBUILD_DOCS=OFF \
-DBUILD_EXAMPLES=OFF \
-DBUILD_TESTS=OFF \
-DBUILD_PERF_TESTS=OFF \
..

$ make -j4
$ sudo make install
```

### C++11/17 ç¼–è¯‘å‘½ä»¤

```shell
$ clang++ -std=c++11 edX.cpp
$ clang++ -std=c++17 edX.cpp
```

### Valgrindå®‰è£…(macOS High Sierra)

```shell
$ brew edit valgrind
	'https://sourceware.org/git/valgrind.git'->'git://sourceware.org/git/valgrind.git'
$ brew update
$ brew install --HEAD valgrind
```

å‚è€ƒ [How to Install Valgrind on macOS High Sierra](https://www.gungorbudak.com/blog/2018/04/28/how-to-install-valgrind-on-macos-high-sierra/)

ä½¿ç”¨æ–¹æ³•

```shell
$ gcc main.cpp -g
$ valgrind --tool=memcheck --leak-check=full --show-reachable=yes ./a.out
```

### libcreateå®‰è£…(macOS)

æ–‡ä»¶ libcreate/src/serial_query.cpp ä¸­

```c++
tcflush(port.lowest_layer().native(), TCIFLUSH);
```

ä¿®æ”¹ä¸º

```c++
tcflush(port.lowest_layer().native_handle(), TCIFLUSH);
```

æ–‡ä»¶ libcreate/src/data.cpp ä¸­æ·»åŠ 

```c++
#include <iostream>
```

å¦åˆ™æç¤ºé”™è¯¯

```shell
error: no member named 'cout' in namespace 'std'
```

### Google Testå®‰è£…

```shell
make
make install
```

[InstallingGoolgeTestForMac.wiki](https://code.google.com/archive/p/tonatiuh/wikis/InstallingGoolgeTestForMac.wiki)

### LattePanda å¯åŠ¨åæ˜¾ç¤ºå±ä¿¡å·ä¸­æ–­

æ¨æµ‹åŸå› ï¼šç”µæµ (1.8A) ä¸è¶³ã€‚

> Any standard USB adapter (such as a cell phone wall charger) with at least 2A of current can be used as a power supply for the LattePanda.

[LattePanda](http://docs.lattepanda.com)



### Pixhawk åˆ›å»º App

æ·»åŠ  CMakeLists.txt å’Œ C ç¨‹åºæºæ–‡ä»¶åï¼Œéœ€è¦ä¿®æ”¹æ–‡ä»¶ï¼š/Firmware/cmake/configs/nuttx_px4fmu-v2_default.cmake

```cmake
examples/px4_simple_app
```

### MYNTEYE ç›¸æœºä½¿ç”¨å‚è€ƒæ–‡ä»¶ CMakeLists

```cmake
cmake_minimum_required(VERSION 2.8)
project(mynteye_sdk_samples)

include(${PROJECT_SOURCE_DIR}/cmake/Common.cmake)
include(${PROJECT_SOURCE_DIR}/cmake/DetectCXX11.cmake)
include(${PROJECT_SOURCE_DIR}/cmake/DetectOpenCV.cmake)

# flags
SET(CMAKE_BUILD_TYPE Release)
set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -Wall -O3")
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wall -O3")

# variables
set(SDK_DIR /Users/zhangjixiang/mynteye-1.8-mac-x64-opencv-3.4.0)
set(SDK_LIB_DIR ${SDK_DIR}/lib)
set(LIB_MYNTEYE_CORE ${CMAKE_SHARED_LIBRARY_PREFIX}mynteye_core${CMAKE_SHARED_LIBRARY_SUFFIX})

message(STATUS "SDK_DIR: ${SDK_DIR}")
message(STATUS "SDK_LIB_DIR: ${SDK_LIB_DIR}")
message(STATUS "LIB_MYNTEYE_CORE: ${LIB_MYNTEYE_CORE}")

# required
include_directories( ${SDK_DIR}/include )

# camera
add_executable(camera camera.cc)
target_link_libraries(camera
  ${SDK_LIB_DIR}/${LIB_MYNTEYE_CORE}
  ${OpenCV_LIBS}
)
```

C++ æºä»£ç ï¼š

```c++
#include <iomanip>
#include <iostream>

#include <opencv2/highgui/highgui.hpp>

#include "camera.h"
#include "utility.h"

using namespace std;
using namespace mynteye;

int main(int argc, char const *argv[]) {
    std::string name;
    if (argc >= 2) {
        name = argv[1];
    } else {
        bool found = false;
        name = FindDeviceName(&found);
    }
    cout << "Open Camera: " << name << endl;

    Camera cam;
    InitParameters params(name);
    cam.Open(params);

    if (!cam.IsOpened()) {
        std::cerr << "Error: Open camera failed" << std::endl;
        return 1;
    }
    std::cout << "\033[1;32mPress ESC/Q on Windows to terminate\033[0m\n";

    double t, fps = 0;
    ErrorCode code;
    cv::Mat img_left;
    for (;;) {
        t = (double)cv::getTickCount();

        code = cam.Grab();

        if (code != ErrorCode::SUCCESS) continue;

        if (cam.RetrieveImage(img_left, View::VIEW_LEFT_UNRECTIFIED) == ErrorCode::SUCCESS)
        {
            // top left: width x height
            stringstream ss;
            ss << img_left.cols << "x" << img_left.rows;
            DrawInfo(img_left, ss.str(), Gravity::TOP_LEFT);
            // top right: fps
            ss.str(""); ss.clear();
            ss << fixed << setw(7) << setprecision(2) << setfill(' ') << fps;
            DrawInfo(img_left, ss.str(), Gravity::TOP_RIGHT);
            cv::imshow("left", img_left);
        }

        char key = (char) cv::waitKey(1);
        if (key == 27 || key == 'q' || key == 'Q') {  // ESC/Q
            cv::imwrite("left.jpg",img_left);
            cout << "Saved Images!" << endl;
            break;
        }

        t = (double)cv::getTickCount() - t;
        fps = cv::getTickFrequency() / t;
    }

    cam.Close();
    cv::destroyAllWindows();
    return 0;
}
```

### åœ¨ macOS ä¸Šå®‰è£… TensorFlow

```shell
$ pip install tensorflow      # Python 2.7; CPU support
```

### Host key verification failed...

```shell
$ ssh-keygen -R hostname
```

### ç¦ç”¨ Win10 é©±åŠ¨ç­¾å

```
ç‚¹å‡»é€šçŸ¥ï¼Œæ‰¾åˆ°å¹¶è¿›å…¥â€œæ‰€æœ‰è®¾ç½®â€
åœ¨æ‰€æœ‰è®¾ç½®ä¸­æ‰¾åˆ°å¹¶è¿›å…¥â€œæ›´æ–°å’Œå®‰å…¨â€
æ‰¾åˆ°æ¢å¤ï¼Œç‚¹å‡»â€œé«˜çº§å¯åŠ¨â€ä¸‹çš„â€œç«‹å³é‡å¯â€ï¼Œé‡å¯ç”µè„‘
é‡å¯åé€‰æ‹©â€œç–‘éš¾è§£ç­”â€
é€‰æ‹©â€œé«˜çº§é€‰é¡¹â€
é€‰æ‹©â€œå¯åŠ¨è®¾ç½®â€
ç‚¹å‡»â€œé‡å¯â€
æŒ‰æç¤ºè¾“å…¥â€œ7â€ç¦ç”¨é©±åŠ¨ç¨‹åºå¼ºåˆ¶ç­¾å
```

### ç”¨pandocå®ç°LaTeXè½¬Word

```shell
$ pandoc -s document.tex -o word.docx
```

### LaTeXå¯¼å…¥pdfæ–‡æ¡£

```latex
\usepackage{pdfpages}
...
\includepdf[pages=-,pagecommand={},width=\textwidth]{file.pdf}
```

### æ ‘è“æ´¾è½¯ä»¶æºé…ç½®

```shell
$ sudo nano /etc/apt/sources.list

deb http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ stretch main non-free contrib
deb-src http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ stretch main non-free contrib
```

### Raspbian Lite to Raspbian PIXEL

```shell
$ sudo apt-get install --no-install-recommends xserver-xorg
$ sudo apt-get install --no-install-recommends xinit
$ sudo apt-get install raspberrypi-ui-mods
$ sudo apt-get install lightdm
```

### ä¿®æ”¹æ ‘è“æ´¾swapåˆ†åŒºå¤§å°

```shell
$ sudo vim /etc/dphys-swapfile
...
ä¿®æ”¹ CONF_SWAPSIZE=2048
...
$ sudo /etc/init.d/dphys-swapfile restart
```

### æ ‘è“æ´¾USBç›¸æœºé©±åŠ¨

ç›¸æœºè®¾å¤‡ /dev/video0

```
$ sudo modprobe bcm2835-v4l2
```



### å›¾åƒçª—å£æ‰“å¼€åé©¬ä¸Šå…³é—­

```c++
if ( (char) cv::waitKey(33) >= 0 )
			break;

ä¿®æ”¹ä¸ºï¼š

if ( cv::waitKey(33) >= 0 )
			break;
```

æŒæ¡ gdb å•æ­¥è°ƒè¯•



### æ‰“å¼€swfæ–‡ä»¶

```html
<html>
	<body>
		<embed src="/Users/zhangjixiang/Downloads/dirtran_mintime_double_integrator_fine.swf" width="100%" height="100%"></embed>
	</body>
</html>
```



### Flask + Arduino Webåº”ç”¨ç¨‹åº

```python
import serial
from time import sleep
from flask import request

from flask import Flask
app = Flask(__name__)
ser = serial.Serial('/dev/tty.usbmodem1411', 9600, timeout=1)

@app.route("/", methods = ['POST', 'GET'])
def hello():
	if request.method == 'POST':
		print request.form['submit']
		# ser = serial.Serial('/dev/tty.usbmodem1411', 9600, timeout=1)
		if request.form['submit'] == 'ON':
			print '1'
			ser.write(b'1')
		elif request.form['submit'] == 'OFF':
			print '0'
			ser.write(b'0')
		else:
			pass # unknown
	return '<form action="/" method="POST"><input type="submit" name="submit" value="ON"><input type="submit" name="submit" value="OFF"></form>'

if __name__ == "__main__":
	# app.run()
	app.run(host='0.0.0.0')
```



### Arduinoä¸²å£æµ‹è¯•ç¨‹åº

```
import serial
import time
from struct import *

mega = serial.Serial(port='/dev/cu.usbmodem1421',
    baudrate=9600, timeout = 3.0)

try:
    while True:
        raw = raw_input('input a char: ')
        mega.write(pack('c',raw))
        # read a '\n' terminated line
        line = mega.readline()
        print line
except Exception as e:
    mega.close()
```

### æ‰‹åŠ¨æ·»åŠ Appimageåº”ç”¨å›¾æ ‡

éœ€è¦æ·»åŠ ä¸¤ä¸ªæ–‡ä»¶ï¼šæ–‡ä»¶å’Œå›¾æ ‡

1. /usr/share/applications/**xxx.desktop**ï¼Œä¾‹å¦‚

   ```
   [Desktop Entry]
   Name=KDEnlive
   Comment=Non Linear Video Editor
   GenericName=Video Editor
   Exec=/home/ajith/Applications/Kdenlive-17.12.0d-x86_64.AppImage   #make sure to change the below path to the path in your system
   Icon=kdenlive   #the icon name for your application will be different
   Type=Application
   StartupNotify=true
   Categories=Qt;KDE;AudioVideo;AudioVideoEditing;
   MimeType=application/x-kdenlive;
   ```

2. /usr/share/icons/hicolor/512x512/apps/**xxx.png**

### åˆ©ç”¨FileZilla SFTPä¼ æ–‡ä»¶

SFTP = SSH File Transfer Protocol



### æ‰“å¼€Ubuntu SSH

```bash
$ sudo apt-get update
$ sudo apt-get install openssh-server
$ sudo ufw allow 22
```

### LaTeX æ ¼å¼è½¬æ¢ Markdown

```bash
pandoc -s example4.tex -o example5.text
```

### Bochså¯åŠ¨é»‘å±

åŸå› ï¼šdebugæ¨¡å¼

Solutionï¼šè¾“å…¥`c`ï¼Œç„¶åå›è½¦æ‰§è¡Œ

```bash
<bochs:1> c
```

### Vim è°ƒè¯•ï¼štermdebug å…¥é—¨

[Vim è°ƒè¯•ï¼štermdebug å…¥é—¨](https://fzheng.me/2018/05/28/termdebug/)

### ImportError in system pip wrappers after an upgrade

```bash
$ python -m pip uninstall pip
```

### How do you calculate program run time in python?

```python
import timeit
start = timeit.default_timer()

#Statements

stop = timeit.default_timer()
print('Time: ', stop - start)
```

### WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!

```bash
$ ssh-keygen -R <host>
```

### Catch a Ctrl-C Event (C++)

```c++
#include <signal.h>
...

void myfunction(int sig) {
  ...
  exit(1);
}

int main(int argc, char** argv) {
  signal(SIGINT, myfunction);
  ...
}
```

### How do I find all files containing specific text on Linux?

```bash
æŸ¥æ‰¾æ‰€æœ‰æ–‡ä»¶ä¸­çš„å†…å®¹
$ grep -rnw '/path/to/somewhere/' -e 'pattern'
$ grep -Ril "text-to-find-here" /

æŸ¥æ‰¾æŒ‡å®šæ–‡ä»¶å
$ find /home/username/ -name "*.err"
```

### è®¾ç½®ä»£ç†æœåŠ¡å™¨å…è®¸å±€åŸŸç½‘çš„å…¶ä»–è®¾å¤‡å…±äº«

ss åå¥½è®¾ç½®->HTTP->HTTPä»£ç†ç›‘å¬åœ°å€->ä¿®æ”¹ä¸º`0.0.0.0`ã€‚

ä»£ç†æœåŠ¡å™¨ä¸»æœºåå†™è¿è¡Œ ss çš„ç”µè„‘çš„ IP åœ°å€ã€‚

### Ubuntuåˆ›å»ºsudoç”¨æˆ·

```bash
$ sudo adduser username
$ usermod -aG sudo username
$ su - username
```

### ROSç”Ÿæˆmsg/srv/actionåç¼–è¯‘package

```bash
$ catkin_make messages_generate_messages
$ catkin_make
```

### Ubuntuç³»ç»Ÿä¸‹æŸ¥çœ‹OpenCVç‰ˆæœ¬

```bash
$ dpkg -l | grep libopencv
```

### æŸ¥çœ‹CUDAç‰ˆæœ¬

```bash
$ nvcc --version
```

### æŸ¥çœ‹CuDNNç‰ˆæœ¬

```bash
$ cat /usr/local/cuda/include/cudnn.h | grep CUDNN_MAJOR -A 2
```

### ä½¿ç”¨pkg-config

```bash
$ pkg-config --cflags librtmp
$ pkg-config --libs librtmp

å¸¸ç”¨å‚æ•°ï¼š
â€“-list-all     åˆ—å‡ºæ‰€æœ‰å·²å®‰è£…çš„å…±äº«åº“
-â€“cflags     åˆ—å‡ºæŒ‡å®šå…±äº«åº“çš„é¢„å¤„ç†å’Œç¼–è¯‘flag
-â€“libs     åˆ—å‡ºæŒ‡å®šå…±äº«åº“çš„é“¾æ¥flag
```

### ç”¨ Python & matplotlib ç»˜å›¾

```python
import re
import numpy as np
import matplotlib as mpl
import matplotlib.pyplot as plt

# read the log file
files = ['00.txt', '01.txt', '02.txt', '03.txt']
iters = [8000, 80000, 8000, 20000]
descr = ['00iter: [8000,4000,8000,4000]         base_lr: 0.001', '01iter: [80000,40000,80000,40000] base_lr: 0.0005', '02iter: [8000,4000,8000,4000]         base_lr: 0.0005', '03iter: [20000,10000,20000,10000] base_lr: 0.0005']
color = ['green', 'red', 'skyblue', 'blue']
plt.title('Result Analysis')

for i in range(4):
  file_log = open(files[i], 'r')
  train_iterations = []
  train_loss = []
  for line in file_log:
    if '] Iteration ' in line and 'loss = ' in line:
      arr = re.findall(r'ion \b\d+\b',line)
      train_iterations.append(int(arr[0].strip(',')[4:]))
      train_loss.append(float(line.strip().split(' = ')[-1]))
  file_log.close()
  print len(train_iterations)
  plt.plot(train_iterations[0:iters[i] / 20], train_loss[0:iters[i] / 20], color=color[i], label=descr[i])

plt.legend()
plt.xlabel('iteration times')
plt.ylabel('loss')
plt.xlim(-20, 2000)
plt.show()
```

### ç”¨ MATLAB æ·»åŠ é«˜æ–¯å’Œæ¤’ç›å™ªéŸ³

```matlab
% add gauss and peper noise
% 2019-02-23
clc
clear all

XmlPath = 'dataset/xml/';
XmlFile = dir(fullfile(XmlPath, '*.xml'));
XmlNames = transpose({XmlFile.name});
Amount = size(XmlNames, 1);
PicPath = 'dataset/';

for k = 1:Amount
    filename = fullfile(XmlPath, XmlNames(k));
    XDoc = xmlread(char(filename));
    xmin = XDoc.getElementsByTagName('object').item(0).getElementsByTagName('xmin').item(0).getFirstChild.getNodeValue; xmin = str2num(xmin);
    ymin = XDoc.getElementsByTagName('object').item(0).getElementsByTagName('ymin').item(0).getFirstChild.getNodeValue; ymin = str2num(ymin);
    xmax = XDoc.getElementsByTagName('object').item(0).getElementsByTagName('xmax').item(0).getFirstChild.getNodeValue; xmax = str2num(xmax);
    ymax = XDoc.getElementsByTagName('object').item(0).getElementsByTagName('ymax').item(0).getFirstChild.getNodeValue; ymax = str2num(ymax);
    ap = [xmin, ymin, xmax, ymax]

    XmlName = char(XmlNames(k));
    PicName = strcat(XmlName(1:6), '.jpg');

    origin = imread(PicName);
    % r = [0 ~ 0.2]
    r = randi([0 200],1,3)/1000
    I_0 = imnoise(origin, 'salt & pepper', r(1));
    Im = imnoise(I_0, 'gaussian', r(2), r(3));
    [rNum,cNum] = size(Im);
    x1 = (xmin+xmax)/2; y1 = (ymin+ymax)/2; radius = (xmax+ymax-xmin-ymin)/4;
    [xx,yy] = ndgrid((1:rNum)-y1,(1:cNum)-x1);
    mask = (xx.^2 + yy.^2) >= radius^2+10^2;
    Im(mask) = uint8(0);
    imwrite(Im, fullfile('newdataset/', PicName))
end
```

### C/C++å­—ç¬¦ä¸²åˆ†å‰²

```c++
/* strtok example */
#include <stdio.h>
#include <string.h>

int main ()
{
  char str[] ="- This, a sample string.";
  char * pch;
  printf ("Splitting string \"%s\" into tokens:\n",str);
  pch = strtok (str," ,.-");
  while (pch != NULL)
  {
    printf ("%s\n",pch);
    pch = strtok (NULL, " ,.-");
  }
  return 0;
}
```

### Latency Numbers Every Programmer Should Know

```
Latency Comparison Numbers (~2012)
----------------------------------
L1 cache reference                           0.5 ns
Branch mispredict                            5   ns
L2 cache reference                           7   ns                      14x L1 cache
Mutex lock/unlock                           25   ns
Main memory reference                      100   ns                      20x L2 cache, 200x L1 cache
Compress 1K bytes with Zippy             3,000   ns        3 us
Send 1K bytes over 1 Gbps network       10,000   ns       10 us
Read 4K randomly from SSD*             150,000   ns      150 us          ~1GB/sec SSD
Read 1 MB sequentially from memory     250,000   ns      250 us
Round trip within same datacenter      500,000   ns      500 us
Read 1 MB sequentially from SSD*     1,000,000   ns    1,000 us    1 ms  ~1GB/sec SSD, 4X memory
Disk seek                           10,000,000   ns   10,000 us   10 ms  20x datacenter roundtrip
Read 1 MB sequentially from disk    20,000,000   ns   20,000 us   20 ms  80x memory, 20X SSD
Send packet CA->Netherlands->CA    150,000,000   ns  150,000 us  150 ms

Notes
-----
1 ns = 10^-9 seconds
1 us = 10^-6 seconds = 1,000 ns
1 ms = 10^-3 seconds = 1,000 us = 1,000,000 ns

Credit
------
By Jeff Dean:               http://research.google.com/people/jeff/
Originally by Peter Norvig: http://norvig.com/21-days.html#answers

Contributions
-------------
'Humanized' comparison:  https://gist.github.com/hellerbarde/2843375
Visual comparison chart: http://i.imgur.com/k0t1e.png
```

### ç”¨ [cloc](https://github.com/AlDanial/cloc) ç»Ÿè®¡ä»£ç é‡

```bash
prompt> cloc gcc-5.2.0/gcc/c
      16 text files.
      15 unique files.
       3 files ignored.

https://github.com/AlDanial/cloc v 1.65  T=0.23 s (57.1 files/s, 188914.0 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
C                               10           4680           6621          30812
C/C++ Header                     3             99            286            496
-------------------------------------------------------------------------------
SUM:                            13           4779           6907          31308
-------------------------------------------------------------------------------
```

### ç¬¦å·è®¡ç®—å°å·¥å…· SymPy

SymPy is a Python library for symbolic mathematics. It aims to become a full-featured computer algebra system (CAS) while keeping the code as simple as possible in order to be comprehensible and easily extensible. SymPy is written entirely in Python.

### Keynote ä¸­æ’å…¥é«˜äº®ä»£ç 

```bash
$ brew install highlight
$ pbpaste | highlight --syntax=c++ -K 17 -u "utf-8" -t 2 -n -O rtf | pbcopy
```

### macOS ç»ˆç«¯æŠ¥é”™ ValueError: unknown locale: UTF-8

```bash
export LC_ALL=en_US.UTF-8
export LANG=en_US.UTF-8
```

### ç†è§£ GitHub

[https://matheecs.github.io/images/Git.jpg](/images/Git.jpg)

### ä½¿ç”¨ CMake/CPack/CTest/Catkin

### IMUæ¨¡å‹

[https://matheecs.github.io/images/imumodel.jpg](/images/imumodel.jpg)

### å®‰è£…LaTeXä¾èµ–åŒ…

```bash
sudo tlmgr install name-of-package
```

### å­¦ä¼šç”¨ Glog, Gflags, Gtest, Doxygen, GitHub CI/CD, Protobuf, clang-format

### è§£å†³å®‰è£…`ros-kinetic-desktop-full`å¤±è´¥

Solutionï¼šä¿ç•™`/etc/apt/sources.list`é»˜è®¤é…ç½®ï¼Œä¸è¦è¦†ç›–åŸæœ‰å†…å®¹

### vimä¸­æ·»åŠ `sudo`æƒé™ä¿å­˜æ–‡æ¡£

```bash
:w !sudo tee %
```

### Ubuntuå®‰è£…ä¸­æ–‡å­—ä½“è§£å†³PDFæ–‡æ¡£æ— æ³•æ˜¾ç¤º

```bash
$ sudo apt-get install language-pack-zh*
$ sudo apt-get install chinese*
$ sudo apt-get install fonts-arphic-ukai fonts-arphic-uming fonts-ipafont-mincho fonts-ipafont-gothic fonts-unfonts-core
```

### é‡‡ç”¨Homebrewå›½å†…æº

```bash
æ›¿æ¢brew.git:
cd "$(brew --repo)"
git remote set-url origin https://mirrors.ustc.edu.cn/brew.git

æ›¿æ¢homebrew-core.git:
cd "$(brew --repo)/Library/Taps/homebrew/homebrew-core"
git remote set-url origin https://mirrors.ustc.edu.cn/homebrew-core.git
```

é‡ç½®

```bash
é‡ç½®brew.git:
cd "$(brew --repo)"
git remote set-url origin https://github.com/Homebrew/brew.git

é‡ç½®homebrew-core.git:
cd "$(brew --repo)/Library/Taps/homebrew/homebrew-core"
git remote set-url origin https://github.com/Homebrew/homebrew-core.git
```

### zsh + Oh My Zsh

macOS Catalina å¼€å§‹é»˜è®¤é‡‡ç”¨ zshï¼Œé…åˆ [Oh My Zsh](https://github.com/robbyrussell/oh-my-zsh) ååˆ†å¥½ç”¨ã€‚

### ç”¨ç»ˆç«¯å‘½ä»¤çƒ§å½•æ ‘è“æ´¾é•œåƒ

```bash
$ sudo diskutil umount /dev/disk2s1
$ sudo dd bs=8m if=./2019-09-26-raspbian-buster-full.img of=/dev/rdisk2
```

### pip3ä½¿ç”¨å›½å†…æº

```bash
pip3 config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple
```

[pypi é•œåƒä½¿ç”¨å¸®åŠ©](https://mirror.tuna.tsinghua.edu.cn/help/pypi/)

### ä½¿ç”¨Minicondaç®¡ç†Pythonç¯å¢ƒå’Œè½¯ä»¶åŒ…

[Miniconda](https://docs.conda.io/en/latest/miniconda.html)

```bash
# æ–°å»º/åˆ é™¤ç¯å¢ƒ
conda create -n env_name python=3.7
conda remove -n env_name --all

# æ¿€æ´»/é€€å‡ºç¯å¢ƒ
conda activate env_name
conda deactivate
```

### æ ‘è“æ´¾3b+å®‰è£…Ubuntu MATE 16.04åå‡ºç°å½©è™¹å±æ— æ³•è”ç½‘ï¼Ÿ